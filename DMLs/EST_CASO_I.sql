USE EST_CASO_I;


-------------------------------------------
-- ABAIXO FICARÁ OS INSERTS DAS TABELAS ---
-------------------------------------------

-- TABELA FORNECEDORES

CREATE TABLE IF NOT EXISTS FORNECEDORES(
#NOMEDOATRIBUTO - TIPO - RESTRIÇÃO DE INTEGRIDADE(OPCIONAL)
FORNEC_COD INT PRIMARY KEY,
FORNEC_NOME VARCHAR(45) NOT NULL,
FORNEC_RUA VARCHAR(45) NOT NULL,
FORNEC_NUMRUA INT,
FORNEC_BAIRRO VARCHAR(45) NOT NULL,
FORNEC_CIDADE VARCHAR(45) NOT NULL,
FORNEC_ESTADO VARCHAR(45) NOT NULL,
FORNEC_PAIS VARCHAR(30) NOT NULL,
FORNEC_CODPOSTAL VARCHAR(10) NOT NULL,
FORNEC_TELEFONE VARCHAR(15) NOT NULL,
FORNEC_CONTATO TEXT NOT NULL
);

-- INSERT

INSERT INTO FORNECEDORES (FORNEC_COD, FORNEC_NOME, FORNEC_RUA, FORNEC_NUMRUA, FORNEC_BAIRRO, FORNEC_CIDADE, FORNEC_ESTADO, FORNEC_PAIS, FORNEC_CODPOSTAL, FORNEC_TELEFONE, FORNEC_CONTATO)
VALUES 
(1, 'Fornecedor A', 'Rua das Flores', 100, 'Centro', 'São Paulo', 'SP', 'Brasil', '01000-000', '(11) 99999-0000', 'Contato A'),
(2, 'Fornecedor B', 'Avenida Central', 200, 'Zona Sul', 'Rio de Janeiro', 'RJ', 'Brasil', '20000-000', '(21) 98888-1111', 'Contato B'),
(3, 'Fornecedor C', 'Rua das Palmeiras', 300, 'Bairro Novo', 'Curitiba', 'PR', 'Brasil', '80000-000', '(41) 97777-2222', 'Contato C'),
(4, 'Fornecedor D', 'Avenida Paulista', 400, 'Centro', 'São Paulo', 'SP', 'Brasil', '01310-000', '(11) 96666-3333', 'Contato D'),
(5, 'Fornecedor E', 'Rua Amazonas', 500, 'Industrial', 'Belo Horizonte', 'MG', 'Brasil', '31000-000', '(31) 95555-4444', 'Contato E');


-- TABELA FILIAIS

CREATE TABLE IF NOT EXISTS FILIAIS(
FILIAL_COD INT PRIMARY KEY,
FILIAL_NOME VARCHAR(45) NOT NULL,
FILIAL_RUA VARCHAR(100) NOT NULL,
FILIAL_NUMRUA INT,
FILIAL_BAIRRO VARCHAR(50) NOT NULL,
FILIAL_CIDADE VARCHAR(50) NOT NULL,
FILIAL_ESTADO VARCHAR(50) NOT NULL,
FILIAL_PAIS VARCHAR(50) NOT NULL,
FILIAL_CODPOSTAL VARCHAR(10) NOT NULL,
FILIAL_CAPACIDADE TEXT NOT NULL);

-- INSERT

INSERT INTO FILIAIS (FILIAL_COD, FILIAL_NOME, FILIAL_RUA, FILIAL_NUMRUA, FILIAL_BAIRRO, FILIAL_CIDADE, FILIAL_ESTADO, FILIAL_PAIS, FILIAL_CODPOSTAL, FILIAL_CAPACIDADE)
VALUES 
(1, 'Filial A', 'Avenida das Américas', 100, 'Centro', 'São Paulo', 'SP', 'Brasil', '01000-000', 'Capacidade de 500 pessoas'),
(2, 'Filial B', 'Rua 24 de Maio', 200, 'Bela Vista', 'Rio de Janeiro', 'RJ', 'Brasil', '20000-000', 'Capacidade de 400 pessoas'),
(3, 'Filial C', 'Alameda Santos', 300, 'Vila Mariana', 'Curitiba', 'PR', 'Brasil', '80000-000', 'Capacidade de 350 pessoas'),
(4, 'Filial D', 'Rua das Laranjeiras', 400, 'Santa Teresa', 'Belo Horizonte', 'MG', 'Brasil', '31000-000', 'Capacidade de 450 pessoas'),
(5, 'Filial E', 'Avenida Beira-Mar', 500, 'Meireles', 'Fortaleza', 'CE', 'Brasil', '60165-121', 'Capacidade de 300 pessoas');

-- TABELA PRODUTOS

CREATE TABLE IF NOT EXISTS PRODUTOS(
PROD_COD INT PRIMARY KEY,
PROD_NOME VARCHAR(50) NOT NULL,
PROD_DESCRICAO TEXT NOT NULL,
PROD_ESPECTEC TEXT NOT NULL,
PROD_QUANT DECIMAL(10,3) NOT NULL,
PROD_PRECOUNIT DECIMAL(10,2) NOT NULL,
PROD_UNIDMEDIDA VARCHAR(10) NOT NULL,
PROD_ESTOQ_MIN DECIMAL(10,3) NOT NULL
);

-- INSERT

INSERT INTO PRODUTOS (PROD_COD, PROD_NOME, PROD_DESCRICAO, PROD_ESPECTEC, PROD_QUANT, PROD_PRECOUNIT, PROD_UNIDMEDIDA, PROD_ESTOQ_MIN)
VALUES 
(1, 'Produto A', 'Descrição do Produto A', 'Especificação técnica do Produto A', 100.000, 50.00, 'unidade', 10.000),
(2, 'Produto B', 'Descrição do Produto B', 'Especificação técnica do Produto B', 200.000, 75.50, 'unidade', 20.000),
(3, 'Produto C', 'Descrição do Produto C', 'Especificação técnica do Produto C', 150.000, 60.00, 'unidade', 15.000),
(4, 'Produto D', 'Descrição do Produto D', 'Especificação técnica do Produto D', 300.000, 80.75, 'unidade', 25.000),
(5, 'Produto E', 'Descrição do Produto E', 'Especificação técnica do Produto E', 250.000, 45.25, 'unidade', 12.000);

-- TABELA PEDIDOS

CREATE TABLE IF NOT EXISTS PEDIDOS(
PED_CODIGO INT PRIMARY KEY,
PED_DATA DATE NOT NULL,
PED_HORA TIME NOT NULL,
PED_PREVISAO DATE NOT NULL,
PED_STATUS ENUM('PENDENTE','CONCLUÍDO','EM ESPERA'),
PED_FORNECEDOR INT NOT NULL, #NOSSA CHAVE ESTRANGEIRA DE FORNECEDOR
-- CRIANDO A REFERENCIA PARA A CHAVE ESTRANGEIRA
-- RESTRIÇÃO APELIDO CH.ESTRANGEIRA(CAMPO CRIADO) REFERENCIA TABELA(CH.PRIMÁRIA)
CONSTRAINT FK_FORNECEDOR FOREIGN KEY (PED_FORNECEDOR) #DAR NOME A RESTRIÇÃO(CONSTRAINT) É UMA BOA PRÁTICA
REFERENCES FORNECEDORES(FORNEC_COD) #REFERENCIA A CHAVE PRIMÁRIA DE FORNECEDORES
);

-- INSERT

INSERT INTO PEDIDOS (PED_CODIGO, PED_DATA, PED_HORA, PED_PREVISAO, PED_STATUS, PED_FORNECEDOR)
VALUES 
(1, '2023-11-01', '08:30:00', '2023-11-10', 'PENDENTE', 1),
(2, '2023-11-02', '09:00:00', '2023-11-12', 'CONCLUÍDO', 2),
(3, '2023-11-03', '10:15:00', '2023-11-14', 'EM ESPERA', 3),
(4, '2023-11-04', '11:45:00', '2023-11-16', 'PENDENTE', 4),
(5, '2023-11-05', '14:30:00', '2023-11-18', 'CONCLUÍDO', 5);

-- TABELA RECEBIMENTOS

CREATE TABLE IF NOT EXISTS RECEBIMENTOS(
RECEB_DATA DATE NOT NULL,
RECEB_HORA TIME NOT NULL,
RECEB_QUANT_PROD DECIMAL(10,3),
RECEB_CONDICAO TEXT NOT NULL,
RECEB_PEDIDOS INT PRIMARY KEY,
CONSTRAINT FK_PEDIDOS FOREIGN KEY(RECEB_PEDIDOS) REFERENCES PEDIDOS(PED_CODIGO));

-- INSERT

INSERT INTO RECEBIMENTOS (RECEB_DATA, RECEB_HORA, RECEB_QUANT_PROD, RECEB_CONDICAO, RECEB_PEDIDOS)
VALUES 
('2023-11-11', '09:30:00', 50.000, 'Em perfeitas condições', 1),
('2023-11-13', '10:45:00', 100.000, 'Pequenos danos na embalagem', 2),
('2023-11-15', '08:20:00', 75.500, 'Em perfeitas condições', 3),
('2023-11-17', '11:00:00', 120.000, 'Produto com sinais de avaria', 4),
('2023-11-19', '15:30:00', 60.750, 'Em perfeitas condições', 5);


-- TABELA PEDIDOS_PRODUTOS

CREATE TABLE IF NOT EXISTS PEDIDOS_PRODUTOS(
PDPR_PEDIDOS INT,
PDPR_PRODUTOS INT,
PRIMARY KEY(PDPR_PEDIDOS,PDPR_PRODUTOS),
PDPR_QUANT DECIMAL(10,3) NOT NULL,
CONSTRAINT PDPR_FK_PEDIDOS FOREIGN KEY(PDPR_PEDIDOS) REFERENCES PEDIDOS(PED_CODIGO),
CONSTRAINT PDPR_FK_PRODUTOS FOREIGN KEY(PDPR_PRODUTOS) REFERENCES PRODUTOS(PROD_COD)
);

-- INSERT

INSERT INTO PEDIDOS_PRODUTOS (PDPR_PEDIDOS, PDPR_PRODUTOS, PDPR_QUANT)
VALUES 
(1, 1, 10.000),
(2, 2, 20.000),
(3, 3, 15.000),
(4, 4, 30.000),
(5, 5, 25.000);

-- TABELA FILIAS_PRODUTOS 

CREATE TABLE IF NOT EXISTS FILIAIS_PRODUTOS(
FLPR_FILIAL INT,
FLPR_PRODUTOS INT,
PRIMARY KEY(FLPR_FILIAL,FLPR_PRODUTOS),
FLPR_QUANT DECIMAL(10,3) NOT NULL,
CONSTRAINT FLPR_FK_FILIAIS FOREIGN KEY(FLPR_FILIAL) REFERENCES FILIAIS(FILIAL_COD),
CONSTRAINT FLPR_FK_PRODUTOS FOREIGN KEY(FLPR_PRODUTOS) REFERENCES PRODUTOS(PROD_COD));

-- INSERT 

INSERT INTO FILIAIS_PRODUTOS (FLPR_FILIAL, FLPR_PRODUTOS, FLPR_QUANT)
VALUES 
(1, 1, 150.500),
(2, 3, 200.750),
(3, 2, 175.250),
(4, 4, 300.000),
(5, 5, 125.125);


-- TABELA FORNECEDORES_PRODUTOS

CREATE TABLE IF NOT EXISTS FORNECEDORES_PRODUTOS(
FRPR_FORNECEDOR INT,
FRPR_PRODUTOS INT,
PRIMARY KEY(FRPR_FORNECEDOR,FRPR_PRODUTOS),
CONSTRAINT FRPR_FK_FORNECEDORES FOREIGN KEY(FRPR_FORNECEDOR)
REFERENCES FORNECEDORES(FORNEC_COD),
CONSTRAINT FRPR_FK_PRODUTOS FOREIGN KEY(FRPR_PRODUTOS) 
REFERENCES PRODUTOS(PROD_COD));

INSERT INTO FORNECEDORES_PRODUTOS (FRPR_FORNECEDOR, FRPR_PRODUTOS)
VALUES 
(1, 1),
(2, 3),
(3, 2),
(4, 4),
(5, 5);

-------------------------------------------
-- ABAIXO FICARÁ OS DELETES DAS TABELAS ---
-------------------------------------------

-- TABELA PEDIDOS_PRODUTOS
DELETE FROM PEDIDOS_PRODUTOS WHERE PDPR_PEDIDOS = 5 AND PDPR_PRODUTOS = 5;

-- TABELA FILIAIS_PRODUTOS
DELETE FROM FILIAIS_PRODUTOS WHERE FLPR_FILIAL = 5;

-- TABELAFORNECEDORES_PRODUTOS
DELETE FROM FORNECEDORES_PRODUTOS WHERE FRPR_PRODUTOS = 5;

-- TABELA RECEBIMENTOS
DELETE FROM RECEBIMENTOS WHERE RECEB_PEDIDOS = 5;

-- TABELA PEDIDOS
DELETE FROM PEDIDOS WHERE PED_CODIGO = 5;

-- TABELA FILIAIS
DELETE FROM FILIAIS WHERE FILIAL_COD = 5;

-- TABELA PRODUTOS
DELETE FROM PRODUTOS WHERE PROD_COD = 5;

-- TABELA FORNECEDORES
DELETE FROM FORNECEDORES WHERE FORNEC_NOME = 'Fornecedor E';


-------------------------------------------
-- ABAIXO FICARÁ OS UPDATES DAS TABELAS ---
-------------------------------------------

-- TABELA FORNECEDORES

UPDATE FORNECEDORES SET FORNEC_RUA = 10 WHERE FORNEC_NOME = 'Fornecedor A';
UPDATE FORNECEDORES SET FORNEC_RUA = 50 WHERE FORNEC_NOME = 'Fornecedor B';

-- TABELA FILIAIS

UPDATE FILIAIS SET FILIAL_ESTADO = 'Espírito Santo' WHERE FILIAL_COD = 1;
UPDATE FILIAIS SET FILIAL_ESTADO = 'Pará' WHERE FILIAL_COD = 6;

-- TABELA PRODUTOS 

UPDATE PRODUTOS SET PROD_PRECOUNIT = 250.00 WHERE PROD_COD = 1;
UPDATE PRODUTOS SET PROD_PRECOUNIT = 300.00 WHERE PROD_COD = 2;

-- TABELA PEDIDOS

UPDATE PEDIDOS SET PED_STATUS = 'CONCLUÍDO' WHERE PED_CODIGO = 1;
UPDATE PEDIDOS SET PED_STATUS = 'CONCLUÍDO' WHERE PED_CODIGO = 2;

-- TABELA RECEBIMENTOS 

UPDATE RECEBIMENTOS SET RECEB_QUANT_PROD = '10.000' WHERE RECEB_DATA = '2023-11-11';
UPDATE RECEBIMENTOS SET RECEB_QUANT_PROD = '20.000' WHERE RECEB_DATA = '2023-11-13';

-- TABELA PEDIDOS_PRODUTOS

UPDATE PEDIDOS_PRODUTOS SET PDPR_QUANT = 20.000 WHERE PDPR_PEDIDOS = 1 AND PDPR_PRODUTOS = 1;
UPDATE PEDIDOS_PRODUTOS SET PDPR_QUANT = 40.000 WHERE PDPR_PEDIDOS = 2 AND PDPR_PRODUTOS = 6;

-- TABELA FILIAS_PRODUTOS

UPDATE FILIAIS_PRODUTOS SET FLPR_QUANT = 180.000 WHERE FLPR_FILIAL = 2 AND FLPR_PRODUTOS = 3;
UPDATE FILIAIS_PRODUTOS SET FLPR_QUANT = 135.500 WHERE FLPR_FILIAL = 5 AND FLPR_PRODUTOS = 5;

-- TABELA FORNECEDORES_PRODUTOS

UPDATE FORNECEDORES_PRODUTOS SET FRPR_PRODUTOS = 2 WHERE FRPR_FORNECEDOR = 1;
UPDATE FORNECEDORES_PRODUTOS SET FRPR_PRODUTOS = 2 WHERE FRPR_FORNECEDOR = 4;




