CREATE SCHEMA EST_CASO_IV;
USE EST_CASO_IV;

-------------------------------------------
-- ABAIXO FICARÁ OS INSERTS DAS TABELAS ---
-------------------------------------------

-- TABELA ALUNOS
CREATE TABLE IF NOT EXISTS ALUNOS (
	ALUNO_ID INT PRIMARY KEY,
    ALUNO_CPF VARCHAR(14) NOT NULL,
    ALUNO_NOME VARCHAR(100) NOT NULL,
    ALUNO_DATANASC DATE NOT NULL,
    ALUNO_RUA VARCHAR(100) NOT NULL,
    ALUNO_NUM INT,
    ALUNO_COMPLEMENTO TEXT,
    ALUNO_BAIRRO VARCHAR(100) NOT NULL,
    ALUNO_CIDADE VARCHAR(100) NOT NULL,
    ALUNO_CEP VARCHAR(15) NOT NULL,
    ALUNO_UF CHAR(2) NOT NULL,
    ALUNO_PAIS VARCHAR(100) NOT NULL
);

-- INSERT ALUNOS
INSERT INTO ALUNOS (ALUNO_ID, ALUNO_CPF, ALUNO_NOME, ALUNO_DATANASC, ALUNO_RUA, ALUNO_NUM, ALUNO_COMPLEMENTO, ALUNO_BAIRRO, ALUNO_CIDADE, ALUNO_CEP, ALUNO_UF, ALUNO_PAIS)
VALUES 
(1, '123.456.789-01', 'Carlos Silva', '2005-08-15', 'Rua das Flores', 101, 'Apto 2', 'Centro', 'São Paulo', '12345-678', 'SP', 'Brasil'),
(2, '234.567.890-12', 'Mariana Souza', '2007-02-25', 'Avenida Paulista', 300, 'Bloco B', 'Bela Vista', 'São Paulo', '23456-789', 'SP', 'Brasil'),
(3, '345.678.901-23', 'João Pedro', '2006-11-10', 'Rua das Acácias', 45, NULL, 'Vila Nova', 'Rio de Janeiro', '34567-890', 'RJ', 'Brasil'),
(4, '456.789.012-34', 'Ana Beatriz', '2004-05-20', 'Rua do Sol', 12, 'Casa', 'Centro', 'Belo Horizonte', '45678-901', 'MG', 'Brasil'),
(5, '567.890.123-45', 'Lucas Rocha', '2003-09-05', 'Praça da Paz', 500, NULL, 'Jardins', 'Porto Alegre', '56789-012', 'RS', 'Brasil');


-- TABELA INSTRUTORES
CREATE TABLE IF NOT EXISTS INSTRUTORES (
	INSTRU_ID INT PRIMARY KEY,
    INSTRU_CPF VARCHAR(14) NOT NULL,
    INSTRU_NOME VARCHAR(100) NOT NULL,
    INSTRU_DATANASC DATE NOT NULL,
	INSTRU_RUA VARCHAR(100) NOT NULL,
    INSTRU_NUM INT,
    INSTRU_COMPLEMENTO TEXT,
    INSTRU_BAIRRO VARCHAR(100) NOT NULL,
    INSTRU_CIDADE VARCHAR(100) NOT NULL,
    INSTRU_CEP VARCHAR(15) NOT NULL,
    INSTRU_UF CHAR(2) NOT NULL,
    INSTRU_PAIS VARCHAR(100) NOT NULL,
    INSTRU_ESPECIALIDADE VARCHAR(100) NOT NULL
);

-- INSERT INSTRUTORES
INSERT INTO INSTRUTORES (INSTRU_ID, INSTRU_CPF, INSTRU_NOME, INSTRU_DATANASC, INSTRU_RUA, INSTRU_NUM, INSTRU_COMPLEMENTO, INSTRU_BAIRRO, INSTRU_CIDADE, INSTRU_CEP, INSTRU_UF, INSTRU_PAIS, INSTRU_ESPECIALIDADE)
VALUES
(1, '678.901.234-56', 'Ricardo Martins', '1985-04-12', 'Rua Beethoven', 220, 'Sala 1', 'Vila Musical', 'São Paulo', '67890-123', 'SP', 'Brasil', 'Violão'),
(2, '789.012.345-67', 'Fernanda Lima', '1990-09-30', 'Rua Chopin', 50, NULL, 'Centro', 'Rio de Janeiro', '78901-234', 'RJ', 'Brasil', 'Piano'),
(3, '890.123.456-78', 'Gabriel Souza', '1988-01-15', 'Avenida Mozart', 310, 'Apto 10', 'Harmonia', 'Curitiba', '89012-345', 'PR', 'Brasil', 'Guitarra'),
(4, '901.234.567-89', 'Patrícia Almeida', '1992-06-22', 'Rua Tchaikovsky', 25, NULL, 'Sonata', 'Fortaleza', '90123-456', 'CE', 'Brasil', 'Bateria'),
(5, '012.345.678-90', 'Luiz Castro', '1978-12-05', 'Rua Vivaldi', 100, 'Casa', 'Ritmo', 'Porto Alegre', '01234-567', 'RS', 'Brasil', 'Saxofone');

-- TABELA MODALIDADES
CREATE TABLE IF NOT EXISTS MODALIDADES (
	MOD_ID INT PRIMARY KEY,
    MOD_NOME VARCHAR(100) NOT NULL,
    MOD_DESCRICAO TEXT NOT NULL
);

-- INSERT MODALIDADES
INSERT INTO MODALIDADES (MOD_ID, MOD_NOME, MOD_DESCRICAO)
VALUES
(1, 'Violão Clássico', 'Aulas voltadas para o aprendizado do violão clássico, técnicas e repertório.'),
(2, 'Piano Contemporâneo', 'Curso de piano com foco em técnicas contemporâneas e improvisação.'),
(3, 'Guitarra Elétrica', 'Ensino das técnicas de guitarra elétrica com ênfase em rock e jazz.'),
(4, 'Bateria', 'Curso prático de bateria para iniciantes e nível intermediário.'),
(5, 'Saxofone Avançado', 'Aulas para aperfeiçoamento das técnicas de saxofone para alunos avançados.');

-- TABELA PLANOS_TREINAMENTOS
CREATE TABLE IF NOT EXISTS PLANOS_TREINAMENTOS (
	PLAN_ID INT PRIMARY KEY,
    ALUNO_ID INT NOT NULL,
    INSTRU_ID INT NOT NULL,
    PLAN_DESCRICAO TEXT NOT NULL,
    PLAN_DATAINICIO DATE NOT NULL,
    PLAN_DATAFIM DATE,
    -- FK vinda da tabela ALUNOS
    CONSTRAINT PLTR_FK_ALUNO FOREIGN KEY(ALUNO_ID) REFERENCES ALUNOS(ALUNO_ID),
    -- FK vinda da tabela INSTRUTOR
    CONSTRAINT PLTR_FK_INSTRUTOR FOREIGN KEY(INSTRU_ID) REFERENCES INSTRUTORES(INSTRU_ID)
);

-- INSERT PLANOS_TREINAMENTOS
INSERT INTO PLANOS_TREINAMENTOS (PLAN_ID, ALUNO_ID, INSTRU_ID, PLAN_DESCRICAO, PLAN_DATAINICIO, PLAN_DATAFIM)
VALUES
(1, 1, 1, 'Plano de aulas de violão clássico para iniciantes', '2024-01-10', '2024-06-10'),
(2, 2, 2, 'Plano de aulas de piano contemporâneo para intermediários', '2024-03-01', '2024-09-01'),
(3, 3, 3, 'Plano de aulas de guitarra elétrica para iniciantes', '2024-02-20', '2024-07-20'),
(4, 4, 4, 'Plano de aulas de bateria para iniciantes', '2024-01-15', '2024-06-15'),
(5, 5, 5, 'Plano de aulas de saxofone avançado', '2024-03-05', '2024-12-05');

-- TABELA AULAS
CREATE TABLE IF NOT EXISTS AULAS (
	AULA_ID INT PRIMARY KEY,
    MOD_ID INT NOT NULL,
    INSTRU_ID INT NOT NULL,
    AULA_HORARIO TIME NOT NULL,
    AULA_CAPACIDADE INT NOT NULL,
    -- FK vinda da tabela MODALIDADES
	CONSTRAINT AULAS_FK_MODALIDADES FOREIGN KEY (MOD_ID) REFERENCES MODALIDADES(MOD_ID),
    -- FK vinda da tabela INSTRUTORES
    CONSTRAINT AULAS_FK_INSTRUTORES FOREIGN KEY (INSTRU_ID) REFERENCES INSTRUTORES(INSTRU_ID)
);

-- INSERT AULAS
INSERT INTO AULAS (AULA_ID, MOD_ID, INSTRU_ID, AULA_HORARIO, AULA_CAPACIDADE)
VALUES
(1, 1, 1, '08:00:00', 15),
(2, 2, 2, '10:00:00', 12),
(3, 3, 3, '14:00:00', 10),
(4, 4, 4, '16:00:00', 20),
(5, 1, 5, '18:00:00', 12);

-- TABELA MATRICULAS
CREATE TABLE IF NOT EXISTS MATRICULAS (
	MATRICULA_ID INT PRIMARY KEY,
    ALUNO_ID INT NOT NULL,
    MOD_ID INT NOT NULL,
    MATRICULA_DATA DATE NOT NULL,
    MATRICULA_STATUS ENUM("MATRICULADO", "NAO MATRICULADO"),
    -- FK vinda da tabela ALUNOS
    CONSTRAINT MATRICULA_FK_ALUNOS FOREIGN KEY (ALUNO_ID) REFERENCES ALUNOS(ALUNO_ID),
    -- FK vinda da tabela MODALIDADES
    CONSTRAINT MATRICULA_FK_MODALIDADES FOREIGN KEY (MOD_ID) REFERENCES MODALIDADES(MOD_ID)
);

-- INSERT MATRICULAS
INSERT INTO MATRICULAS (MATRICULA_ID, ALUNO_ID, MOD_ID, MATRICULA_DATA, MATRICULA_STATUS)
VALUES
(1, 1, 1, '2024-01-10', 'MATRICULADO'),
(2, 2, 2, '2024-03-01', 'MATRICULADO'),
(3, 3, 3, '2024-02-20', 'MATRICULADO'),
(4, 4, 4, '2024-01-15', 'MATRICULADO'),
(5, 5, 1, '2024-03-05', 'NAO MATRICULADO');

-- TABELA PAGAMENTOS
CREATE TABLE IF NOT EXISTS PAGAMENTOS (
	PAG_ID INT PRIMARY KEY,
    MATRICULA_ID INT NOT NULL,
    PAG_DATA DATE NOT NULL,
    PAG_VALOR DECIMAL(10, 3) NOT NULL,
    PAG_STATUS ENUM("PAGO", "PENDENTE"),
    -- FK vinda da tabela MATRICULAS
    CONSTRAINT PAG_FK_MATRICULAS FOREIGN KEY(MATRICULA_ID) REFERENCES MATRICULAS(MATRICULA_ID)
);

-- INSERT PAGAMENTOS
INSERT INTO PAGAMENTOS (PAG_ID, MATRICULA_ID, PAG_DATA, PAG_VALOR, PAG_STATUS)
VALUES
(1, 1, '2024-01-15', 500.00, 'PAGO'),
(2, 2, '2024-03-05', 600.00, 'PENDENTE'),
(3, 4, '2024-02-10', 400.00, 'PAGO'),
(4, 3, '2024-02-25', 550.00, 'PENDENTE'),
(5, 5, '2024-03-15', 650.00, 'PAGO');

-- TABELA ALUNOS_AULAS
CREATE TABLE IF NOT EXISTS ALUNOS_AULAS (
	AULA_ID INT,
    ALUNO_ID INT,
    PRIMARY KEY(AULA_ID, ALUNO_ID),
    -- FK vinda da tabela AULAS
    CONSTRAINT ALAU_FK_AULAS FOREIGN KEY(AULA_ID) REFERENCES AULAS(AULA_ID),
    -- FK vinda da tabela ALUNOS    
    CONSTRAINT ALAU_FK_ALUNOS FOREIGN KEY(ALUNO_ID) REFERENCES ALUNOS(ALUNO_ID) 
);

-- INSERT ALUNOS_AULAS
INSERT INTO ALUNOS_AULAS (AULA_ID, ALUNO_ID)
VALUES
(1, 1),
(2, 2),
(3, 3),
(4, 4),
(5, 5);

-------------------------------------------
-- ABAIXO FICARÁ OS DELETES DAS TABELAS ---
-------------------------------------------

-- TABELA ALUNOS
DELETE FROM ALUNOS WHERE ALUNO_ID = 3;

-- TABELA INSTRUTORES
DELETE FROM INSTRUTORES WHERE INSTRU_ID = 4;

-- TABELA MODALIDADES
DELETE FROM MODALIDADES WHERE MOD_ID = 5;

-- TABELA PLANOS_TREINAMENTOS
DELETE FROM PLANOS_TREINAMENTOS WHERE PLAN_ID = 3;

-- TABELA AULAS
DELETE FROM AULAS WHERE AULA_ID = 3;

-- TABELA MATRICULAS
DELETE FROM MATRICULAS WHERE MATRICULA_ID = 3;

-- TABELA PAGAMENTOS
DELETE FROM PAGAMENTOS WHERE PAG_ID = 2;

-- TABELA ALUNOS_AULAS
DELETE FROM ALUNOS_AULAS WHERE AULA_ID = 3 AND ALUNO_ID = 3;

-------------------------------------------
-- ABAIXO FICARÁ OS UPDATES DAS TABELAS ---
-------------------------------------------

-- TABELA ALUNOS
UPDATE ALUNOS SET ALUNO_NOME = 'Carlos Henrique Silva' WHERE ALUNO_ID = 1;
UPDATE ALUNOS SET ALUNO_RUA = 'Rua Nova Esperança', ALUNO_NUM = 150 WHERE ALUNO_ID = 2;

-- TABELA INSTRUTORES
UPDATE INSTRUTORES SET INSTRU_NOME = 'Ricardo M. Silva' WHERE INSTRU_ID = 1;
UPDATE INSTRUTORES SET INSTRU_ESPECIALIDADE = 'Teclado' WHERE INSTRU_ID = 2;

-- TABELA MODALIDADES
UPDATE MODALIDADES SET MOD_DESCRICAO = 'Aulas para aprendizado do violão clássico e popular.' WHERE MOD_ID = 1;
UPDATE MODALIDADES SET MOD_NOME = 'Bateria Intermediária' WHERE MOD_ID = 4;

-- TABELA PLANOS_TREINAMENTOS
UPDATE PLANOS_TREINAMENTOS SET PLAN_DESCRICAO = 'Plano de aulas de violão clássico para nível intermediário' WHERE PLAN_ID = 1;
UPDATE PLANOS_TREINAMENTOS SET PLAN_DATAFIM = '2024-12-01' WHERE PLAN_ID = 2;

-- TABELA AULAS
UPDATE AULAS SET AULA_HORARIO = '09:00:00' WHERE AULA_ID = 1;
UPDATE AULAS SET AULA_CAPACIDADE = 18 WHERE AULA_ID = 4;

-- TABELA MATRICULAS
UPDATE MATRICULAS SET MATRICULA_STATUS = 'NAO MATRICULADO' WHERE MATRICULA_ID = 1;
UPDATE MATRICULAS SET MATRICULA_STATUS = 'MATRICULADO' WHERE MATRICULA_ID = 5;

-- TABELA PAGAMENTOS
UPDATE PAGAMENTOS SET PAG_VALOR = 530.00 WHERE PAG_ID = 1;
UPDATE PAGAMENTOS SET PAG_STATUS = 'PAGO' WHERE PAG_ID = 4;

-- TABELA ALUNOS_AULAS
UPDATE ALUNOS_AULAS SET ALUNO_ID = 1 WHERE AULA_ID = 5 AND ALUNO_ID = 5;
UPDATE ALUNOS_AULAS SET AULA_ID = 2 WHERE AULA_ID = 4 AND ALUNO_ID = 4;







